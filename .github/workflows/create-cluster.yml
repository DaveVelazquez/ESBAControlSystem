# Crear solo cluster ECS - deployment m√≠nimo
name: Create ECS Cluster Only

on:
  workflow_dispatch:

env:
  AWS_REGION: us-east-1
  ECS_CLUSTER: field-service-cluster

jobs:
  create-cluster:
    name: Create ECS Cluster
    runs-on: ubuntu-latest
    
    steps:
      - name: Configure AWS credentials
        uses: aws-actions/configure-aws-credentials@v4
        with:
          aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}
          aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
          aws-region: ${{ env.AWS_REGION }}

      - name: Create ECS Cluster
        run: |
          echo "Creating ECS cluster: ${{ env.ECS_CLUSTER }}"
          aws ecs create-cluster --cluster-name ${{ env.ECS_CLUSTER }} || {
            echo "Cluster may already exist or creation failed"
            aws ecs describe-clusters --clusters ${{ env.ECS_CLUSTER }}
          }
          
      - name: Create CloudWatch Log Group
        run: |
          echo "Creating log group for backend service"
          aws logs create-log-group --log-group-name "/ecs/backend-service" || {
            echo "Log group may already exist"
          }
          
      - name: Verify cluster creation
        run: |
          echo "Verifying cluster status"
          aws ecs describe-clusters --clusters ${{ env.ECS_CLUSTER }} --query "clusters[0].status"